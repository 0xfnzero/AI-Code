# ç¬¬ä¸ƒè¯¾ï¼šè¿›é˜¶æŠ€å·§å’Œæœ€ä½³å®è·µ

> ğŸ¯ **å­¦ä¹ ç›®æ ‡**ï¼šæŒæ¡é«˜çº§å¼€å‘æŠ€å·§ï¼Œæå‡ä»£ç è´¨é‡å’Œå¼€å‘æ•ˆç‡

## 1. æç¤ºè¯ä¼˜åŒ–æŠ€å·§

### ç²¾ç¡®æè¿°éœ€æ±‚

**âŒ æ¨¡ç³Šçš„æç¤º**ï¼š
```
åšä¸€ä¸ªç½‘ç«™
```

**âœ… ç²¾ç¡®çš„æç¤º**ï¼š
```
åˆ›å»ºä¸€ä¸ªç”µå•†äº§å“å±•ç¤ºé¡µé¢ï¼Œè¦æ±‚ï¼š
- ä½¿ç”¨å¡ç‰‡å¸ƒå±€ï¼Œæ¯è¡Œ 3 ä¸ªäº§å“
- æ¯ä¸ªäº§å“å¡ç‰‡åŒ…å«ï¼šå›¾ç‰‡ï¼ˆ16:9ï¼‰ã€æ ‡é¢˜ã€ä»·æ ¼ã€è¯„åˆ†
- é¼ æ ‡æ‚¬åœæ—¶å¡ç‰‡è½»å¾®ä¸Šæµ®å¹¶æ˜¾ç¤ºé˜´å½±
- ç‚¹å‡»å¡ç‰‡è·³è½¬åˆ°è¯¦æƒ…é¡µ
- ä½¿ç”¨è“ç™½é…è‰²æ–¹æ¡ˆ
- å“åº”å¼è®¾è®¡ï¼Œæ‰‹æœºä¸Šæ¯è¡Œæ˜¾ç¤º 1 ä¸ª
```

### åˆ†æ­¥éª¤æŒ‡å¯¼

**æç¤ºæ¨¡æ¿**ï¼š
```
ç¬¬ä¸€æ­¥ï¼š[å…·ä½“ä»»åŠ¡]
ç¬¬äºŒæ­¥ï¼š[å…·ä½“ä»»åŠ¡]
ç¬¬ä¸‰æ­¥ï¼š[å…·ä½“ä»»åŠ¡]

æ¯å®Œæˆä¸€æ­¥åç­‰æˆ‘ç¡®è®¤å†ç»§ç»­
```

**ç¤ºä¾‹**ï¼š
```
å¸®æˆ‘é‡æ„è¿™ä¸ªç™»å½•æ¨¡å—ï¼Œåˆ†ä¸‰æ­¥è¿›è¡Œï¼š
ç¬¬ä¸€æ­¥ï¼šæå–è¡¨å•éªŒè¯é€»è¾‘ä¸ºç‹¬ç«‹å‡½æ•°
ç¬¬äºŒæ­¥ï¼šä¼˜åŒ–é”™è¯¯å¤„ç†æœºåˆ¶
ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ å•å…ƒæµ‹è¯•

å®Œæˆç¬¬ä¸€æ­¥åæš‚åœï¼Œè®©æˆ‘review
```

### æä¾›ä¸Šä¸‹æ–‡

```
èƒŒæ™¯ï¼šæˆ‘æ­£åœ¨å¼€å‘ä¸€ä¸ªåœ¨çº¿æ•™è‚²å¹³å°
æŠ€æœ¯æ ˆï¼šReact + Node.js + MongoDB
å½“å‰é—®é¢˜ï¼šç”¨æˆ·ç™»å½•åï¼Œè¯¾ç¨‹åˆ—è¡¨åŠ è½½å¾ˆæ…¢
å·²å°è¯•ï¼šæ·»åŠ äº†loadingåŠ¨ç”»ï¼Œä½†è¿˜æ˜¯æ…¢

è¯·å¸®æˆ‘åˆ†ææ€§èƒ½ç“¶é¢ˆå¹¶æä¾›ä¼˜åŒ–æ–¹æ¡ˆ
```

### ä½¿ç”¨ç¤ºä¾‹å’Œå‚è€ƒ

```
å¸®æˆ‘åˆ›å»ºä¸€ä¸ªå¯¼èˆªæ ï¼Œç±»ä¼¼ GitHub çš„é¡¶éƒ¨å¯¼èˆªï¼š
- å·¦ä¾§ Logo å’Œæœç´¢æ¡†
- å³ä¾§ç”¨æˆ·å¤´åƒå’Œä¸‹æ‹‰èœå•
- æ»šåŠ¨æ—¶å›ºå®šåœ¨é¡¶éƒ¨
- æœ‰è½»å¾®çš„æ¨¡ç³ŠèƒŒæ™¯æ•ˆæœ

å‚è€ƒï¼šhttps://github.comï¼ˆæè¿°æƒ³è¦çš„æ•ˆæœï¼‰
```

## 2. ä»£ç å®¡æŸ¥ä¸ä¼˜åŒ–

### è¯·æ±‚ä»£ç å®¡æŸ¥

```
ä½ ï¼šå®¡æŸ¥è¿™æ®µä»£ç ï¼ŒæŒ‡å‡ºé—®é¢˜å’Œæ”¹è¿›å»ºè®®ï¼š

function getUserData(id) {
  fetch('https://api.example.com/users/' + id)
    .then(res => res.json())
    .then(data => {
      console.log(data)
      document.getElementById('user-name').innerHTML = data.name
    })
}

Claudeï¼šæˆ‘å‘ç°ä»¥ä¸‹é—®é¢˜ï¼š

1. ç¼ºå°‘é”™è¯¯å¤„ç†
2. æ²¡æœ‰æ£€æŸ¥å“åº”çŠ¶æ€
3. ä½¿ç”¨ innerHTML æœ‰ XSS é£é™©
4. ç¡¬ç¼–ç  DOM ID
5. æ²¡æœ‰è¿”å›å€¼

æ”¹è¿›å»ºè®®ï¼š

async function getUserData(id) {
  try {
    const response = await fetch(`https://api.example.com/users/${id}`)

    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`)
    }

    const data = await response.json()

    // å®‰å…¨åœ°æ›´æ–° DOM
    const userNameEl = document.getElementById('user-name')
    if (userNameEl) {
      userNameEl.textContent = data.name
    }

    return data
  } catch (error) {
    console.error('Failed to fetch user data:', error)
    throw error
  }
}
```

### æ€§èƒ½ä¼˜åŒ–åˆ†æ

```
ä½ ï¼šè¿™æ®µä»£ç æœ‰æ€§èƒ½é—®é¢˜ï¼Œå¸®æˆ‘ä¼˜åŒ–ï¼š

function filterProducts(products, keyword) {
  let result = []
  for (let i = 0; i < products.length; i++) {
    for (let j = 0; j < products[i].tags.length; j++) {
      if (products[i].tags[j].includes(keyword)) {
        result.push(products[i])
        break
      }
    }
  }
  return result
}

Claudeï¼šé—®é¢˜åˆ†æï¼š
1. åµŒå¥—å¾ªç¯ï¼Œæ—¶é—´å¤æ‚åº¦ O(n*m)
2. å¯ä»¥ä½¿ç”¨æ›´ç®€æ´çš„æ•°ç»„æ–¹æ³•

ä¼˜åŒ–æ–¹æ¡ˆ 1ï¼ˆæ›´æ¸…æ™°ï¼‰ï¼š
function filterProducts(products, keyword) {
  return products.filter(product =>
    product.tags.some(tag => tag.includes(keyword))
  )
}

ä¼˜åŒ–æ–¹æ¡ˆ 2ï¼ˆæ›´å¿«ï¼Œå¦‚æœæ•°æ®é‡å¤§ï¼‰ï¼š
function filterProducts(products, keyword) {
  const result = []
  const lowerKeyword = keyword.toLowerCase()

  for (const product of products) {
    if (product.tags.some(tag =>
      tag.toLowerCase().includes(lowerKeyword)
    )) {
      result.push(product)
    }
  }

  return result
}

æ€§èƒ½å¯¹æ¯”ï¼š
- åŸä»£ç ï¼š~450msï¼ˆ10000æ¡æ•°æ®ï¼‰
- ä¼˜åŒ–åï¼š~180msï¼ˆ60% æå‡ï¼‰
```

### ä»£ç é‡æ„å»ºè®®

```
ä½ ï¼šè¿™ä¸ªç»„ä»¶å¤ªé•¿äº†ï¼ˆ300è¡Œï¼‰ï¼Œå¸®æˆ‘é‡æ„

Claudeï¼šåˆ†æä»£ç ç»“æ„åï¼Œå»ºè®®æ‹†åˆ†ä¸ºï¼š

åŸç»„ä»¶ï¼šUserDashboard.js (300è¡Œ)

é‡æ„åï¼š
components/
â”œâ”€â”€ UserDashboard.js (ä¸»å®¹å™¨ï¼Œ50è¡Œ)
â”œâ”€â”€ UserProfile.js (ä¸ªäººä¿¡æ¯ï¼Œ60è¡Œ)
â”œâ”€â”€ UserStats.js (ç»Ÿè®¡æ•°æ®ï¼Œ40è¡Œ)
â”œâ”€â”€ ActivityFeed.js (æ´»åŠ¨æµï¼Œ80è¡Œ)
â””â”€â”€ SettingsPanel.js (è®¾ç½®é¢æ¿ï¼Œ70è¡Œ)

ä¼˜åŠ¿ï¼š
- æ¯ä¸ªç»„ä»¶èŒè´£å•ä¸€
- ä¾¿äºæµ‹è¯•
- å¯å¤ç”¨æ€§é«˜
- æ˜“äºç»´æŠ¤

è¦æˆ‘å¼€å§‹é‡æ„å—ï¼Ÿ
```

## 3. è°ƒè¯•æŠ€å·§

### ç³»ç»ŸåŒ–è°ƒè¯•æµç¨‹

```
ä½ ï¼šç™»å½•åŠŸèƒ½ä¸å·¥ä½œï¼Œä¸çŸ¥é“å“ªé‡Œé”™äº†

Claudeï¼šè®©æˆ‘ä»¬ç³»ç»Ÿæ€§åœ°æ’æŸ¥ï¼š

ç¬¬ä¸€æ­¥ï¼šå¤ç°é—®é¢˜
- ä½ æ‰§è¡Œäº†ä»€ä¹ˆæ“ä½œï¼Ÿ
- çœ‹åˆ°ä»€ä¹ˆé”™è¯¯ä¿¡æ¯ï¼Ÿ
- æ˜¯å¦æ‰“å¼€äº†æµè§ˆå™¨æ§åˆ¶å°ï¼Ÿ

ç¬¬äºŒæ­¥ï¼šæ£€æŸ¥å‰ç«¯
1. æ£€æŸ¥è¡¨å•æ•°æ®æ˜¯å¦æ­£ç¡®æ”¶é›†
2. æ£€æŸ¥è¯·æ±‚æ˜¯å¦å‘é€
3. æ£€æŸ¥è¯·æ±‚å‚æ•°æ ¼å¼

ç¬¬ä¸‰æ­¥ï¼šæ£€æŸ¥ç½‘ç»œ
1. æŸ¥çœ‹ Network æ ‡ç­¾
2. æ£€æŸ¥è¯·æ±‚çŠ¶æ€ç 
3. æŸ¥çœ‹å“åº”å†…å®¹

ç¬¬å››æ­¥ï¼šæ£€æŸ¥åç«¯
1. æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
2. æ£€æŸ¥è·¯ç”±æ˜¯å¦æ­£ç¡®
3. éªŒè¯æ•°æ®åº“æŸ¥è¯¢

æˆ‘ä¼šå¸®ä½ é€æ­¥æ£€æŸ¥æ¯ä¸ªç¯èŠ‚...
```

### æ·»åŠ è°ƒè¯•ä»£ç 

```
ä½ ï¼šå¸®æˆ‘æ·»åŠ è¯¦ç»†çš„æ—¥å¿—ï¼Œæ–¹ä¾¿è°ƒè¯•

Claudeï¼š
ä¸ºä½ çš„ä»£ç æ·»åŠ ç»“æ„åŒ–æ—¥å¿—ï¼š

// ä¹‹å‰
async function loginUser(credentials) {
  const response = await api.login(credentials)
  setUser(response.user)
}

// ä¹‹å
async function loginUser(credentials) {
  console.group('ğŸ” User Login')
  console.log('Credentials:', { ...credentials, password: '***' })

  try {
    console.time('API Call')
    const response = await api.login(credentials)
    console.timeEnd('API Call')

    console.log('Response:', response)

    if (response.user) {
      setUser(response.user)
      console.log('âœ… Login successful')
    }
  } catch (error) {
    console.error('âŒ Login failed:', error)
    throw error
  } finally {
    console.groupEnd()
  }
}

æ·»åŠ çš„è°ƒè¯•åŠŸèƒ½ï¼š
- åˆ†ç»„æ—¥å¿—ï¼ˆä¾¿äºæŠ˜å ï¼‰
- æ€§èƒ½è®¡æ—¶
- æ•æ„Ÿä¿¡æ¯ä¿æŠ¤
- æ¸…æ™°çš„æˆåŠŸ/å¤±è´¥æ ‡è¯†
```

### æ–­ç‚¹è°ƒè¯•æŒ‡å¯¼

```
ä½ ï¼šæ•™æˆ‘å¦‚ä½•ä½¿ç”¨æ–­ç‚¹è°ƒè¯•

Claudeï¼š
è®¾ç½®æ–­ç‚¹çš„æ–¹æ³•ï¼š

æ–¹æ³• 1ï¼šæµè§ˆå™¨å¼€å‘è€…å·¥å…·
1. æ‰“å¼€ Sources æ ‡ç­¾
2. æ‰¾åˆ°ä½ çš„ JS æ–‡ä»¶
3. ç‚¹å‡»è¡Œå·è®¾ç½®æ–­ç‚¹
4. åˆ·æ–°é¡µé¢è§¦å‘æ–­ç‚¹

æ–¹æ³• 2ï¼šä»£ç ä¸­æ·»åŠ 
debugger;  // ç¨‹åºä¼šåœ¨è¿™é‡Œæš‚åœ

æ–¹æ³• 3ï¼šæ¡ä»¶æ–­ç‚¹
å³é”®è¡Œå· â†’ æ·»åŠ æ¡ä»¶æ–­ç‚¹
ä¾‹å¦‚ï¼šuserId === 123

è°ƒè¯•æ—¶çš„æ“ä½œï¼š
- F8ï¼šç»§ç»­æ‰§è¡Œ
- F10ï¼šå•æ­¥è·³è¿‡
- F11ï¼šå•æ­¥è¿›å…¥
- é¼ æ ‡æ‚¬åœæŸ¥çœ‹å˜é‡å€¼
- Console ä¸­å¯ä»¥æ‰§è¡Œä»£ç 

å®ä¾‹ï¼šè°ƒè¯•ç™»å½•å‡½æ•°
function login(username, password) {
  debugger;  // æš‚åœåœ¨è¿™é‡Œ
  const user = findUser(username);
  debugger;  // æ£€æŸ¥ user çš„å€¼
  if (validatePassword(user, password)) {
    debugger;  // æ£€æŸ¥éªŒè¯ç»“æœ
    return createSession(user);
  }
}
```

## 4. è®¾è®¡æ¨¡å¼åº”ç”¨

### å•ä¾‹æ¨¡å¼

```
ä½ ï¼šåˆ›å»ºä¸€ä¸ªå…¨å±€é…ç½®ç®¡ç†å™¨ï¼Œç¡®ä¿åªæœ‰ä¸€ä¸ªå®ä¾‹

Claudeï¼š
ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼š

class Config {
  static instance = null;

  constructor() {
    if (Config.instance) {
      return Config.instance;
    }

    this.settings = {
      apiUrl: 'https://api.example.com',
      theme: 'light',
      language: 'zh-CN'
    };

    Config.instance = this;
  }

  get(key) {
    return this.settings[key];
  }

  set(key, value) {
    this.settings[key] = value;
  }
}

// ä½¿ç”¨
const config1 = new Config();
const config2 = new Config();
console.log(config1 === config2);  // true

// æˆ–è€…ä½¿ç”¨æ›´ç®€æ´çš„æ–¹å¼
const config = {
  settings: {
    apiUrl: 'https://api.example.com',
    theme: 'light'
  },

  get(key) {
    return this.settings[key];
  },

  set(key, value) {
    this.settings[key] = value;
  }
};

export default config;
```

### è§‚å¯Ÿè€…æ¨¡å¼

```
ä½ ï¼šå®ç°ä¸€ä¸ªäº‹ä»¶ç³»ç»Ÿï¼Œå½“æ•°æ®æ›´æ–°æ—¶é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…

Claudeï¼š
å®ç°è§‚å¯Ÿè€…æ¨¡å¼ï¼š

class EventEmitter {
  constructor() {
    this.events = {};
  }

  // è®¢é˜…äº‹ä»¶
  on(event, callback) {
    if (!this.events[event]) {
      this.events[event] = [];
    }
    this.events[event].push(callback);

    // è¿”å›å–æ¶ˆè®¢é˜…å‡½æ•°
    return () => this.off(event, callback);
  }

  // å–æ¶ˆè®¢é˜…
  off(event, callback) {
    if (!this.events[event]) return;

    this.events[event] = this.events[event]
      .filter(cb => cb !== callback);
  }

  // è§¦å‘äº‹ä»¶
  emit(event, data) {
    if (!this.events[event]) return;

    this.events[event].forEach(callback => {
      callback(data);
    });
  }

  // åªè®¢é˜…ä¸€æ¬¡
  once(event, callback) {
    const onceCallback = (data) => {
      callback(data);
      this.off(event, onceCallback);
    };
    this.on(event, onceCallback);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const emitter = new EventEmitter();

// è®¢é˜…ç”¨æˆ·ç™»å½•äº‹ä»¶
emitter.on('user:login', (user) => {
  console.log('ç”¨æˆ·ç™»å½•:', user.name);
  updateUI(user);
});

emitter.on('user:login', (user) => {
  console.log('è®°å½•æ—¥å¿—');
  logActivity(user);
});

// è§¦å‘äº‹ä»¶
emitter.emit('user:login', { name: 'å¼ ä¸‰', id: 123 });
```

### å·¥å‚æ¨¡å¼

```
ä½ ï¼šåˆ›å»ºä¸åŒç±»å‹çš„è¡¨å•æ§ä»¶ï¼ˆè¾“å…¥æ¡†ã€ä¸‹æ‹‰æ¡†ã€æ—¥æœŸé€‰æ‹©å™¨ï¼‰

Claudeï¼š
ä½¿ç”¨å·¥å æ¨¡å¼ï¼š

class FormFieldFactory {
  static createField(type, config) {
    switch (type) {
      case 'text':
        return new TextField(config);
      case 'select':
        return new SelectField(config);
      case 'date':
        return new DateField(config);
      case 'checkbox':
        return new CheckboxField(config);
      default:
        throw new Error(`Unknown field type: ${type}`);
    }
  }
}

// åŸºç¡€å­—æ®µç±»
class FormField {
  constructor(config) {
    this.name = config.name;
    this.label = config.label;
    this.required = config.required || false;
  }

  validate() {
    if (this.required && !this.value) {
      return `${this.label} æ˜¯å¿…å¡«é¡¹`;
    }
    return null;
  }

  render() {
    // å­ç±»å®ç°
  }
}

// æ–‡æœ¬è¾“å…¥æ¡†
class TextField extends FormField {
  render() {
    return `
      <div class="form-field">
        <label>${this.label}</label>
        <input type="text" name="${this.name}"
               ${this.required ? 'required' : ''}>
      </div>
    `;
  }
}

// ä¸‹æ‹‰æ¡†
class SelectField extends FormField {
  constructor(config) {
    super(config);
    this.options = config.options || [];
  }

  render() {
    const optionsHTML = this.options
      .map(opt => `<option value="${opt.value}">${opt.label}</option>`)
      .join('');

    return `
      <div class="form-field">
        <label>${this.label}</label>
        <select name="${this.name}" ${this.required ? 'required' : ''}>
          ${optionsHTML}
        </select>
      </div>
    `;
  }
}

// ä½¿ç”¨
const nameField = FormFieldFactory.createField('text', {
  name: 'username',
  label: 'ç”¨æˆ·å',
  required: true
});

const cityField = FormFieldFactory.createField('select', {
  name: 'city',
  label: 'åŸå¸‚',
  options: [
    { value: 'bj', label: 'åŒ—äº¬' },
    { value: 'sh', label: 'ä¸Šæµ·' }
  ]
});
```

## 5. é”™è¯¯å¤„ç†æœ€ä½³å®è·µ

### ç»Ÿä¸€é”™è¯¯å¤„ç†

```
ä½ ï¼šåˆ›å»ºä¸€ä¸ªç»Ÿä¸€çš„é”™è¯¯å¤„ç†ç³»ç»Ÿ

Claudeï¼š
å®ç°å…¨å±€é”™è¯¯å¤„ç†ï¼š

// é”™è¯¯ç±»å‹å®šä¹‰
class AppError extends Error {
  constructor(message, statusCode, code) {
    super(message);
    this.statusCode = statusCode;
    this.code = code;
    this.isOperational = true;
  }
}

class ValidationError extends AppError {
  constructor(message, field) {
    super(message, 400, 'VALIDATION_ERROR');
    this.field = field;
  }
}

class AuthError extends AppError {
  constructor(message) {
    super(message, 401, 'AUTH_ERROR');
  }
}

class NotFoundError extends AppError {
  constructor(resource) {
    super(`${resource} not found`, 404, 'NOT_FOUND');
    this.resource = resource;
  }
}

// é”™è¯¯å¤„ç†å™¨
class ErrorHandler {
  static handle(error) {
    if (error.isOperational) {
      return this.handleOperationalError(error);
    }
    return this.handleProgrammerError(error);
  }

  static handleOperationalError(error) {
    // ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
    const message = this.getUserMessage(error);
    this.showNotification(message, 'error');

    // è®°å½•æ—¥å¿—
    console.error('[Operational Error]', {
      message: error.message,
      code: error.code,
      stack: error.stack
    });
  }

  static handleProgrammerError(error) {
    // ä¸¥é‡é”™è¯¯ï¼Œéœ€è¦å¼€å‘è€…å…³æ³¨
    console.error('[Programmer Error]', error);

    // æ˜¾ç¤ºé€šç”¨é”™è¯¯ä¿¡æ¯
    this.showNotification(
      'å‘ç”Ÿäº†ä¸€ä¸ªé”™è¯¯ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•',
      'error'
    );

    // å¯ä»¥å‘é€åˆ°é”™è¯¯ç›‘æ§æœåŠ¡
    // this.reportToSentry(error);
  }

  static getUserMessage(error) {
    const messages = {
      'VALIDATION_ERROR': `è¾“å…¥éªŒè¯å¤±è´¥: ${error.message}`,
      'AUTH_ERROR': 'è®¤è¯å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•',
      'NOT_FOUND': 'è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨',
      'NETWORK_ERROR': 'ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ'
    };

    return messages[error.code] || 'æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•';
  }

  static showNotification(message, type) {
    // å®ç°é€šçŸ¥UI
    console.log(`[${type.toUpperCase()}]`, message);
  }
}

// å…¨å±€é”™è¯¯æ•è·
window.addEventListener('error', (event) => {
  ErrorHandler.handle(event.error);
});

window.addEventListener('unhandledrejection', (event) => {
  ErrorHandler.handle(event.reason);
});

// ä½¿ç”¨ç¤ºä¾‹
async function login(username, password) {
  try {
    if (!username) {
      throw new ValidationError('ç”¨æˆ·åä¸èƒ½ä¸ºç©º', 'username');
    }

    const response = await api.login(username, password);

    if (!response.ok) {
      throw new AuthError('ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯');
    }

    return response.data;
  } catch (error) {
    ErrorHandler.handle(error);
    throw error;  // å¦‚æœéœ€è¦ç»§ç»­ä¼ æ’­
  }
}
```

### API è¯·æ±‚é”™è¯¯å¤„ç†

```
ä½ ï¼šåˆ›å»ºä¸€ä¸ªå¥å£®çš„ API è¯·æ±‚å‡½æ•°ï¼Œå¤„ç†å„ç§é”™è¯¯æƒ…å†µ

Claudeï¼š
å®ç°å¸¦é‡è¯•å’Œè¶…æ—¶çš„ API è¯·æ±‚ï¼š

class APIClient {
  constructor(baseURL, options = {}) {
    this.baseURL = baseURL;
    this.timeout = options.timeout || 10000;
    this.retryCount = options.retryCount || 3;
    this.retryDelay = options.retryDelay || 1000;
  }

  async request(endpoint, options = {}) {
    const url = `${this.baseURL}${endpoint}`;
    let lastError;

    // é‡è¯•é€»è¾‘
    for (let attempt = 0; attempt < this.retryCount; attempt++) {
      try {
        // æ·»åŠ è¶…æ—¶æ§åˆ¶
        const response = await Promise.race([
          fetch(url, {
            ...options,
            headers: {
              'Content-Type': 'application/json',
              ...this.getAuthHeaders(),
              ...options.headers
            }
          }),
          this.timeout(this.timeout)
        ]);

        // æ£€æŸ¥å“åº”çŠ¶æ€
        if (!response.ok) {
          throw await this.handleHTTPError(response);
        }

        return await response.json();

      } catch (error) {
        lastError = error;

        // åˆ¤æ–­æ˜¯å¦åº”è¯¥é‡è¯•
        if (!this.shouldRetry(error, attempt)) {
          break;
        }

        // ç­‰å¾…åé‡è¯•
        await this.delay(this.retryDelay * (attempt + 1));
        console.log(`Retrying... (${attempt + 1}/${this.retryCount})`);
      }
    }

    // æ‰€æœ‰é‡è¯•éƒ½å¤±è´¥
    throw lastError;
  }

  // è¶…æ—¶Promise
  timeoutPromise(ms) {
    return new Promise((_, reject) =>
      setTimeout(() => reject(new Error('Request timeout')), ms)
    );
  }

  // å»¶è¿Ÿå‡½æ•°
  delay(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }

  // åˆ¤æ–­æ˜¯å¦åº”è¯¥é‡è¯•
  shouldRetry(error, attempt) {
    // è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°
    if (attempt >= this.retryCount - 1) {
      return false;
    }

    // ç½‘ç»œé”™è¯¯æˆ–è¶…æ—¶ï¼Œå¯ä»¥é‡è¯•
    if (error.message === 'Request timeout' ||
        error.message === 'Failed to fetch') {
      return true;
    }

    // 5xx æœåŠ¡å™¨é”™è¯¯ï¼Œå¯ä»¥é‡è¯•
    if (error.statusCode >= 500) {
      return true;
    }

    // 4xx å®¢æˆ·ç«¯é”™è¯¯ï¼Œä¸é‡è¯•
    return false;
  }

  // å¤„ç† HTTP é”™è¯¯
  async handleHTTPError(response) {
    let errorData;
    try {
      errorData = await response.json();
    } catch {
      errorData = { message: response.statusText };
    }

    const error = new Error(errorData.message || 'Request failed');
    error.statusCode = response.status;
    error.response = errorData;

    return error;
  }

  // è·å–è®¤è¯å¤´
  getAuthHeaders() {
    const token = localStorage.getItem('auth_token');
    return token ? { 'Authorization': `Bearer ${token}` } : {};
  }

  // ä¾¿æ·æ–¹æ³•
  get(endpoint, options) {
    return this.request(endpoint, { ...options, method: 'GET' });
  }

  post(endpoint, data, options) {
    return this.request(endpoint, {
      ...options,
      method: 'POST',
      body: JSON.stringify(data)
    });
  }

  put(endpoint, data, options) {
    return this.request(endpoint, {
      ...options,
      method: 'PUT',
      body: JSON.stringify(data)
    });
  }

  delete(endpoint, options) {
    return this.request(endpoint, { ...options, method: 'DELETE' });
  }
}

// ä½¿ç”¨
const api = new APIClient('https://api.example.com', {
  timeout: 5000,
  retryCount: 3,
  retryDelay: 1000
});

// ç¤ºä¾‹è¯·æ±‚
try {
  const users = await api.get('/users');
  const newUser = await api.post('/users', { name: 'å¼ ä¸‰' });
} catch (error) {
  console.error('APIè¯·æ±‚å¤±è´¥:', error);
}
```

## 6. å®‰å…¨æœ€ä½³å®è·µ

### è¾“å…¥éªŒè¯å’Œæ¸…ç†

```
ä½ ï¼šåˆ›å»ºå®‰å…¨çš„è¾“å…¥éªŒè¯å‡½æ•°ï¼Œé˜²æ­¢ XSS å’Œæ³¨å…¥æ”»å‡»

Claudeï¼š
å®ç°è¾“å…¥éªŒè¯å’Œæ¸…ç†ï¼š

class InputValidator {
  // æ¸…ç† HTMLï¼Œé˜²æ­¢ XSS
  static sanitizeHTML(input) {
    const map = {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#x27;',
      '/': '&#x2F;'
    };
    return input.replace(/[&<>"'/]/g, char => map[char]);
  }

  // éªŒè¯é‚®ç®±
  static isValidEmail(email) {
    const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return regex.test(email);
  }

  // éªŒè¯å¯†ç å¼ºåº¦
  static isStrongPassword(password) {
    // è‡³å°‘8ä½ï¼ŒåŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—å’Œç‰¹æ®Šå­—ç¬¦
    const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
    return regex.test(password);
  }

  // éªŒè¯ç”¨æˆ·å
  static isValidUsername(username) {
    // 3-20ä½ï¼Œåªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿
    const regex = /^[a-zA-Z0-9_]{3,20}$/;
    return regex.test(username);
  }

  // é˜²æ­¢ SQL æ³¨å…¥ï¼ˆå‰ç«¯éªŒè¯ï¼‰
  static containsSQLInjection(input) {
    const sqlPatterns = [
      /(\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|EXECUTE)\b)/i,
      /(--|\#|\/\*|\*\/)/,
      /(\bOR\b|\bAND\b).*=.*=/i
    ];

    return sqlPatterns.some(pattern => pattern.test(input));
  }

  // ç»¼åˆéªŒè¯
  static validate(input, rules) {
    const errors = [];

    if (rules.required && !input) {
      errors.push('æ­¤å­—æ®µå¿…å¡«');
    }

    if (rules.minLength && input.length < rules.minLength) {
      errors.push(`æœ€å°‘${rules.minLength}ä¸ªå­—ç¬¦`);
    }

    if (rules.maxLength && input.length > rules.maxLength) {
      errors.push(`æœ€å¤š${rules.maxLength}ä¸ªå­—ç¬¦`);
    }

    if (rules.email && !this.isValidEmail(input)) {
      errors.push('é‚®ç®±æ ¼å¼ä¸æ­£ç¡®');
    }

    if (rules.strongPassword && !this.isStrongPassword(input)) {
      errors.push('å¯†ç å¼ºåº¦ä¸å¤Ÿ');
    }

    if (rules.noSQLInjection && this.containsSQLInjection(input)) {
      errors.push('è¾“å…¥åŒ…å«éæ³•å­—ç¬¦');
    }

    return {
      valid: errors.length === 0,
      errors
    };
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const username = userInput.username;
const validation = InputValidator.validate(username, {
  required: true,
  minLength: 3,
  maxLength: 20,
  noSQLInjection: true
});

if (!validation.valid) {
  console.error('éªŒè¯å¤±è´¥:', validation.errors);
}

// æ¸…ç†ç”¨æˆ·è¾“å…¥ç”¨äºæ˜¾ç¤º
const safeContent = InputValidator.sanitizeHTML(userInput.content);
document.getElementById('output').textContent = safeContent;
```

### å®‰å…¨å­˜å‚¨æ•æ„Ÿä¿¡æ¯

```
ä½ ï¼šå¦‚ä½•å®‰å…¨åœ°å­˜å‚¨ç”¨æˆ·ä»¤ç‰Œå’Œæ•æ„Ÿä¿¡æ¯ï¼Ÿ

Claudeï¼š
å®‰å…¨å­˜å‚¨æœ€ä½³å®è·µï¼š

class SecureStorage {
  // ä¸è¦å°†æ•æ„Ÿä¿¡æ¯å­˜åœ¨ localStorageï¼ˆæ˜“è¢« XSS æ”»å‡»ï¼‰
  // ä½¿ç”¨ httpOnly cookie æˆ–å†…å­˜å­˜å‚¨

  constructor() {
    // å†…å­˜å­˜å‚¨ï¼ˆåˆ·æ–°é¡µé¢ä¼šä¸¢å¤±ï¼‰
    this.memoryStorage = new Map();
  }

  // å­˜å‚¨æ•æ„Ÿä¿¡æ¯åˆ°å†…å­˜
  setSecure(key, value) {
    this.memoryStorage.set(key, value);
  }

  // è·å–æ•æ„Ÿä¿¡æ¯
  getSecure(key) {
    return this.memoryStorage.get(key);
  }

  // æ¸…é™¤æ•æ„Ÿä¿¡æ¯
  clearSecure(key) {
    this.memoryStorage.delete(key);
  }

  // éæ•æ„Ÿä¿¡æ¯å¯ä»¥ç”¨ localStorageï¼ˆåŠ å¯†ï¼‰
  setLocal(key, value) {
    try {
      const encrypted = this.encrypt(JSON.stringify(value));
      localStorage.setItem(key, encrypted);
    } catch (error) {
      console.error('å­˜å‚¨å¤±è´¥:', error);
    }
  }

  getLocal(key) {
    try {
      const encrypted = localStorage.getItem(key);
      if (!encrypted) return null;

      const decrypted = this.decrypt(encrypted);
      return JSON.parse(decrypted);
    } catch (error) {
      console.error('è¯»å–å¤±è´¥:', error);
      return null;
    }
  }

  // ç®€å•çš„åŠ å¯†ï¼ˆä»…ç”¨äºæ¼”ç¤ºï¼Œç”Ÿäº§ç¯å¢ƒåº”ä½¿ç”¨ä¸“ä¸šåŠ å¯†åº“ï¼‰
  encrypt(text) {
    // ä½¿ç”¨ Web Crypto API æˆ–ä¸“ä¸šåº“å¦‚ crypto-js
    return btoa(text);  // ç®€åŒ–ç¤ºä¾‹
  }

  decrypt(encrypted) {
    return atob(encrypted);  // ç®€åŒ–ç¤ºä¾‹
  }

  // ä½¿ç”¨ sessionStorageï¼ˆæ ‡ç­¾é¡µå…³é—­åæ¸…é™¤ï¼‰
  setSession(key, value) {
    sessionStorage.setItem(key, JSON.stringify(value));
  }

  getSession(key) {
    const value = sessionStorage.getItem(key);
    return value ? JSON.parse(value) : null;
  }
}

// æœ€ä½³å®è·µ
const storage = new SecureStorage();

// âœ… è®¤è¯ä»¤ç‰Œå­˜åœ¨å†…å­˜æˆ– httpOnly cookie
storage.setSecure('auth_token', token);

// âœ… ç”¨æˆ·åå¥½å¯ä»¥å­˜ localStorageï¼ˆåŠ å¯†ï¼‰
storage.setLocal('preferences', {
  theme: 'dark',
  language: 'zh-CN'
});

// âŒ ä¸è¦è¿™æ ·åš
localStorage.setItem('password', password);  // æ°¸è¿œä¸è¦å­˜å¯†ç 
localStorage.setItem('credit_card', cardNumber);  // ä¸è¦å­˜æ•æ„Ÿä¿¡æ¯
```

### CSP (Content Security Policy)

```
ä½ ï¼šå¦‚ä½•é…ç½® CSP æé«˜å®‰å…¨æ€§ï¼Ÿ

Claudeï¼š
æ·»åŠ  CSP å¤´éƒ¨ï¼š

åœ¨ HTML ä¸­ï¼š
<meta http-equiv="Content-Security-Policy"
      content="default-src 'self';
               script-src 'self' https://trusted-cdn.com;
               style-src 'self' 'unsafe-inline';
               img-src 'self' data: https:;
               font-src 'self' https://fonts.gstatic.com;
               connect-src 'self' https://api.example.com;
               frame-ancestors 'none';
               base-uri 'self';
               form-action 'self';">

æˆ–åœ¨æœåŠ¡å™¨é…ç½®ï¼ˆExpressï¼‰ï¼š
const helmet = require('helmet');

app.use(helmet.contentSecurityPolicy({
  directives: {
    defaultSrc: ["'self'"],
    scriptSrc: ["'self'", "https://trusted-cdn.com"],
    styleSrc: ["'self'", "'unsafe-inline'"],
    imgSrc: ["'self'", "data:", "https:"],
    connectSrc: ["'self'", "https://api.example.com"],
    fontSrc: ["'self'", "https://fonts.gstatic.com"],
    objectSrc: ["'none'"],
    upgradeInsecureRequests: []
  }
}));

CSP è§„åˆ™è¯´æ˜ï¼š
- default-src 'self'ï¼šé»˜è®¤åªå…è®¸åŒæºèµ„æº
- script-srcï¼šé™åˆ¶ JavaScript æ¥æº
- style-srcï¼šé™åˆ¶ CSS æ¥æº
- img-srcï¼šé™åˆ¶å›¾ç‰‡æ¥æº
- connect-srcï¼šé™åˆ¶ AJAX/WebSocket è¿æ¥
- frame-ancestors 'none'ï¼šé˜²æ­¢è¢«åµŒå…¥ iframe
```

## 7. æ€§èƒ½ç›‘æ§

### å®ç°æ€§èƒ½è¿½è¸ª

```
ä½ ï¼šåˆ›å»ºä¸€ä¸ªæ€§èƒ½ç›‘æ§ç³»ç»Ÿ

Claudeï¼š
å®ç°æ€§èƒ½ç›‘æ§ï¼š

class PerformanceMonitor {
  constructor() {
    this.metrics = {};
  }

  // æµ‹é‡å‡½æ•°æ‰§è¡Œæ—¶é—´
  measure(name, fn) {
    return async (...args) => {
      const start = performance.now();

      try {
        const result = await fn(...args);
        const duration = performance.now() - start;

        this.record(name, duration);
        return result;
      } catch (error) {
        const duration = performance.now() - start;
        this.record(name, duration, 'error');
        throw error;
      }
    };
  }

  // è®°å½•æŒ‡æ ‡
  record(name, duration, status = 'success') {
    if (!this.metrics[name]) {
      this.metrics[name] = {
        count: 0,
        totalTime: 0,
        avgTime: 0,
        minTime: Infinity,
        maxTime: 0,
        errors: 0
      };
    }

    const metric = this.metrics[name];
    metric.count++;
    metric.totalTime += duration;
    metric.avgTime = metric.totalTime / metric.count;
    metric.minTime = Math.min(metric.minTime, duration);
    metric.maxTime = Math.max(metric.maxTime, duration);

    if (status === 'error') {
      metric.errors++;
    }

    // æ€§èƒ½è­¦å‘Š
    if (duration > 1000) {
      console.warn(`âš ï¸ æ€§èƒ½è­¦å‘Š: ${name} è€—æ—¶ ${duration.toFixed(2)}ms`);
    }
  }

  // ç›‘æ§é¡µé¢åŠ è½½æ€§èƒ½
  measurePageLoad() {
    if (window.performance) {
      const timing = performance.timing;
      const metrics = {
        // DNS æŸ¥è¯¢æ—¶é—´
        dns: timing.domainLookupEnd - timing.domainLookupStart,
        // TCP è¿æ¥æ—¶é—´
        tcp: timing.connectEnd - timing.connectStart,
        // è¯·æ±‚å“åº”æ—¶é—´
        request: timing.responseEnd - timing.requestStart,
        // DOM è§£ææ—¶é—´
        domParse: timing.domInteractive - timing.domLoading,
        // èµ„æºåŠ è½½æ—¶é—´
        resourceLoad: timing.loadEventStart - timing.domContentLoadedEventEnd,
        // æ€»åŠ è½½æ—¶é—´
        total: timing.loadEventEnd - timing.navigationStart
      };

      console.table(metrics);
      return metrics;
    }
  }

  // ç›‘æ§ API è¯·æ±‚
  monitorAPI(apiClient) {
    const originalRequest = apiClient.request.bind(apiClient);

    apiClient.request = async (endpoint, options) => {
      const start = performance.now();

      try {
        const result = await originalRequest(endpoint, options);
        const duration = performance.now() - start;

        this.record(`API: ${endpoint}`, duration);
        return result;
      } catch (error) {
        const duration = performance.now() - start;
        this.record(`API: ${endpoint}`, duration, 'error');
        throw error;
      }
    };
  }

  // ç”ŸæˆæŠ¥å‘Š
  generateReport() {
    console.group('ğŸ“Š æ€§èƒ½æŠ¥å‘Š');

    Object.entries(this.metrics).forEach(([name, metric]) => {
      console.group(name);
      console.log(`è°ƒç”¨æ¬¡æ•°: ${metric.count}`);
      console.log(`å¹³å‡è€—æ—¶: ${metric.avgTime.toFixed(2)}ms`);
      console.log(`æœ€çŸ­è€—æ—¶: ${metric.minTime.toFixed(2)}ms`);
      console.log(`æœ€é•¿è€—æ—¶: ${metric.maxTime.toFixed(2)}ms`);
      console.log(`é”™è¯¯æ¬¡æ•°: ${metric.errors}`);
      console.groupEnd();
    });

    console.groupEnd();

    return this.metrics;
  }

  // æ¸…ç©ºæŒ‡æ ‡
  reset() {
    this.metrics = {};
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const monitor = new PerformanceMonitor();

// åŒ…è£…éœ€è¦ç›‘æ§çš„å‡½æ•°
const fetchUsers = monitor.measure('fetchUsers', async () => {
  const response = await fetch('/api/users');
  return response.json();
});

// ç›‘æ§ API å®¢æˆ·ç«¯
monitor.monitorAPI(apiClient);

// é¡µé¢åŠ è½½æ—¶ç›‘æ§
window.addEventListener('load', () => {
  monitor.measurePageLoad();
});

// å®šæœŸç”ŸæˆæŠ¥å‘Š
setInterval(() => {
  monitor.generateReport();
}, 60000);  // æ¯åˆ†é’Ÿ
```

## 8. ä¸‹ä¸€æ­¥

ğŸ‘‰ ä¸‹ä¸€è¯¾ï¼š[Claude Code é«˜çº§åº”ç”¨](./08-é«˜çº§åº”ç”¨.md)

å­¦ä¹ æ›´å¤šé«˜çº§è¯é¢˜ï¼š
- ä¸ AI åä½œçš„é«˜çº§æŠ€å·§
- å¤æ‚é¡¹ç›®æ¶æ„è®¾è®¡
- è‡ªåŠ¨åŒ–æµ‹è¯•å’Œ CI/CD
- å¤šè¯­è¨€é¡¹ç›®å¼€å‘

---

ğŸ’¡ **æœ¬è¯¾è¦ç‚¹å›é¡¾**ï¼š
- æç¤ºè¯ä¼˜åŒ–èƒ½å¤§å¹…æå‡æ•ˆç‡
- ä»£ç å®¡æŸ¥å’Œé‡æ„æ˜¯æŒç»­çš„è¿‡ç¨‹
- ç³»ç»ŸåŒ–çš„è°ƒè¯•æ–¹æ³•å¾ˆé‡è¦
- è®¾è®¡æ¨¡å¼æé«˜ä»£ç è´¨é‡
- å®‰å…¨æ°¸è¿œæ˜¯ç¬¬ä¸€ä½çš„
- æ€§èƒ½ç›‘æ§å¸®åŠ©å‘ç°é—®é¢˜
