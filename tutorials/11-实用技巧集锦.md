# 第十一课：Claude Code 实用技巧集锦

> 🎯 **学习目标**：掌握 34 条实用技巧，全面提升 Claude Code 使用效率

## 📚 课程概述

本课程汇总了 Claude Code 的 34 条实用技巧，涵盖命令行操作、图像处理、集成配置、自定义命令、工作流优化等六大领域，帮助你成为 Claude Code 高手。

## 📖 技巧分类

### 一、命令行 (CLI) 技巧（7条）

#### 1. 将其视为 CLI 工具
从根本上理解 Claude Code 是一个命令行工具，具备所有 CLI 基本特性。

**实践应用：**
```bash
# 直接在终端运行
claude "帮我创建一个React组件"

# 在项目目录中运行
cd my-project
claude "分析项目结构并给出优化建议"
```

#### 2. 传递命令参数
使用 `-P` 参数在命令行模式下运行。

**示例：**
```bash
# 使用 -P 参数传递提示
claude -P "重构 src/utils.js 文件"

# 组合多个参数
claude -P "添加单元测试" --files src/app.js
```

#### 3. 使用无界面模式
使用 `-P` 参数在无界面前端的模式下运行，适合自动化场景。

**自动化脚本示例：**
```bash
#!/bin/bash
# 自动化代码审查脚本
claude -P "审查最近的代码变更" > review.md
```

#### 4. 与其他工具联接
将其他命令行工具（bash/CLI工具）连接到工作流。

**实战示例：**
```bash
# 与 git 结合
git diff | claude -P "分析这些代码变更"

# 与 npm 结合
npm test 2>&1 | claude -P "分析测试失败原因"

# 与 grep 结合
grep -r "TODO" . | claude -P "整理所有待办事项"
```

#### 5. 使用管道输入
通过管道（|）将数据输入到 Claude Code 中。

**管道操作示例：**
```bash
# 分析日志
cat error.log | claude -P "找出错误模式并给出解决方案"

# 处理命令输出
ls -la | claude -P "分析目录结构是否合理"

# 多级管道
cat package.json | jq '.dependencies' | claude -P "检查依赖版本"
```

#### 6. 运行多实例
可以同时运行多个 Claude Code 实例处理不同任务。

**多实例应用：**
```bash
# 终端1：处理前端
cd frontend && claude

# 终端2：处理后端
cd backend && claude

# 终端3：运行测试
claude -P "持续监控测试结果"
```

#### 7. 让它启动自己
可以指令 Claude Code 启动一个新的实例来处理任务。

**示例对话：**
```
你：这个任务很复杂，请启动一个新的 Claude Code 实例来专门处理数据库迁移

Claude：好的，我将启动一个新实例...
[新实例启动并专注处理数据库任务]
```

---

### 二、图像处理技巧（6条）

#### 8. 拖拽粘贴图像
将图像文件直接拖入终端使用。

**操作步骤：**
1. 准备好图像文件（设计稿、截图等）
2. 直接拖拽到 Claude Code 终端
3. 描述你的需求

**应用场景：**
- 从 UI 设计稿生成代码
- 分析界面布局
- 复制现有界面设计

#### 9. macOS 截图粘贴
使用快捷键 `Shift+Command+Control+4` 将截图直接复制到剪贴板。

**macOS 快捷键：**
- `Shift+Command+Control+4`：截图到剪贴板（可选区域）
- `Shift+Command+Control+3`：全屏截图到剪贴板

#### 10. 使用 Control+V 粘贴
用 `Control+V`（而不是 `Command+V`）将图片粘贴到终端。

**注意事项：**
- macOS 终端使用 `Control+V` 而非 `Command+V`
- 确保图片已在剪贴板中
- 支持多种图片格式

#### 11. 从设计稿生成代码
粘贴设计稿图片，让 Claude Code 构建界面。

**实践示例：**
```
你：[粘贴 Figma 设计稿截图]
    请根据这个设计稿生成 React 组件代码

Claude：
我看到这是一个登录表单设计，包含：
- 邮箱输入框
- 密码输入框
- 记住我复选框
- 登录按钮

我将创建对应的 React 组件...
[生成代码]
```

#### 12. 建立视觉反馈循环
截取应用的当前状态，将其反馈给 Claude Code 进行迭代修改。

**迭代流程：**
```
1. 运行应用
2. 截图当前状态
3. 粘贴给 Claude Code
4. 描述需要的改进
5. Claude Code 修改代码
6. 重复步骤 1-5
```

**对话示例：**
```
你：[粘贴当前界面截图]
    按钮太小了，文字间距不够，整体需要更现代化

Claude：
我看到了当前界面，我将进行以下调整：
1. 增大按钮尺寸到 48px 高度
2. 增加行高到 1.6
3. 使用现代化的阴影效果
[修改代码]
```

#### 13. 自动化截图生成
使用 Puppeteer MCP 服务自动化生成应用的截图流程。

**自动化配置：**
```javascript
// .claude/puppeteer-automation.js
module.exports = {
  autoScreenshot: true,
  interval: 5000, // 每5秒截图一次
  outputDir: './screenshots'
};
```

---

### 三、集成与外部数据技巧（5条）

#### 14. 充当 MCP 服务器/客户端
Claude Code 本身既可以作为 MCP 服务器，也可以作为客户端连接其他服务。

**MCP 架构理解：**
```
Claude Code (客户端) ←→ MCP 服务器 (数据库/API/文件系统)
Claude Code (服务器) ←→ 其他工具 (客户端)
```

**配置示例：**
```json
// claude_desktop_config.json
{
  "mcpServers": {
    "custom-server": {
      "command": "node",
      "args": ["./my-mcp-server.js"]
    }
  }
}
```

#### 15. 连接数据库
使用 Postgres MCP 服务器连接 Claude Code 到你的数据库。

**配置数据库连接：**
```json
{
  "mcpServers": {
    "postgres": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-postgres"],
      "env": {
        "POSTGRES_CONNECTION_STRING": "postgresql://user:pass@localhost/mydb"
      }
    }
  }
}
```

**使用示例：**
```
你：查询 users 表中最近注册的 10 个用户

Claude：
[通过 MCP 连接数据库]
SELECT * FROM users ORDER BY created_at DESC LIMIT 10;
[返回查询结果]
```

#### 16. 获取最新 API 文档
利用 Cloudflare 等公司提供的 MCP 服务器，获取实时更新的文档。

**配置 API 文档服务：**
```json
{
  "mcpServers": {
    "cloudflare-docs": {
      "command": "npx",
      "args": ["@cloudflare/mcp-server-cloudflare"]
    }
  }
}
```

#### 17. 抓取链接内容
直接粘贴一个 URL，Claude Code 会抓取该网页的内容作为上下文。

**URL 抓取示例：**
```
你：https://react.dev/learn/thinking-in-react
    根据这篇文章的方法重构我们的组件

Claude：
[抓取并分析文章内容]
我已经阅读了 React 官方的"Thinking in React"文章，
让我按照文章中的方法来重构组件...
```

#### 18. 获取外部知识
使用 URL 抓取功能获取外部世界的知识（如游戏规则）并应用到代码中。

**实践案例：**
```
你：https://en.wikipedia.org/wiki/Chess
    帮我实现一个国际象棋游戏的移动验证逻辑

Claude：
[抓取国际象棋规则]
基于国际象棋的规则，我将实现各个棋子的移动验证：
1. 兵的移动规则...
2. 车的移动规则...
[生成代码]
```

---

### 四、claude.md 配置文件技巧（7条）

#### 19. 理解其核心作用
`claude.md` 是一个在每次请求时都会加载的系统提示文件。

**claude.md 的作用：**
- 定义项目的上下文和约定
- 设置代码风格偏好
- 提供项目特定的知识
- 自动加载到每次对话中

#### 20. 使用 /init 自动生成
在项目目录中运行 `/init` 命令，自动生成一份基于项目结构的 `claude.md`。

**操作步骤：**
```bash
cd my-project
claude

# 在 Claude Code 中执行
/init
```

**自动生成的内容包括：**
- 项目结构分析
- 技术栈识别
- 代码风格检测
- 常见约定

#### 21. 用 # 动态更新
在对话中，使用 `#` 符号可以将指令直接添加到 `claude.md`。

**动态更新示例：**
```
你：# 所有 API 调用都要包含错误处理和重试逻辑

Claude：
已添加到 claude.md，我会在后续所有 API 相关的代码中
遵循这个规则。
```

#### 22. 设置全局配置
在用户主目录 `~/.claude/` 中创建 `claude.md` 以应用于所有项目。

**全局配置示例：**
```markdown
# ~/.claude/claude.md

# 个人编码偏好
- 使用 TypeScript 严格模式
- 组件使用函数式风格
- 优先使用 async/await 而非 Promise.then()
- 所有函数都要有 JSDoc 注释

# 代码风格
- 使用 2 空格缩进
- 单引号优先
- 末尾加分号
```

#### 23. 使用子目录配置
在子目录中添加 `claude.md` 应用于特定模块。

**目录结构示例：**
```
my-project/
├── claude.md              # 项目全局配置
├── frontend/
│   └── claude.md          # 前端特定配置
└── backend/
    └── claude.md          # 后端特定配置
```

**前端 claude.md：**
```markdown
# Frontend Module

## 技术栈
- React 18
- Tailwind CSS
- React Router v6

## 组件约定
- 所有组件使用 TypeScript
- Props 定义为 interface
- 使用 React.FC 类型
```

#### 24. 定期重载优化
经常性地优化和精炼你的 `claude.md` 文件，保持其具体性和高效性。

**优化建议：**
- 每月审查一次
- 删除过时的规则
- 添加新的最佳实践
- 保持简洁明了

#### 25. 使用提示优化工具
可以借助 Anthropic 的提示优化工具来改进 `claude.md` 的内容。

**优化流程：**
```
你：/optimize-prompt
    [粘贴当前 claude.md 内容]

Claude：
我将使用提示优化最佳实践来改进你的 claude.md：
1. 使指令更具体
2. 添加示例
3. 改进结构
[提供优化后的版本]
```

---

### 五、定义斜杠命令技巧（6条）

#### 26. 在指定文件夹中定义
在 `.claude/slash_commands` 文件夹中创建文件来自定义自己的斜杠命令。

**目录结构：**
```
my-project/
└── .claude/
    └── slash_commands/
        ├── solve_issue.md
        ├── refactor.md
        ├── lint.md
        └── review_pr.md
```

#### 27. 为解决 GitHub 问题创建命令
创建一个 `/solve_github_issue` 类似的命令。

**创建文件：** `.claude/slash_commands/solve_issue.md`
```markdown
# Solve GitHub Issue

## 指令
分析 GitHub issue #{issue_number}，并提供解决方案：

1. 读取 issue 描述和讨论
2. 分析问题根源
3. 提出解决方案
4. 实现代码修复
5. 编写测试
6. 准备 PR 描述

## 参数
- {issue_number}: GitHub issue 编号
```

**使用：**
```
/solve_issue 123
```

#### 28. 为重构创建命令
创建一个 `/refactor` 命令。

**创建文件：** `.claude/slash_commands/refactor.md`
```markdown
# Refactor Code

## 指令
对 {file_path} 进行代码重构：

1. 分析当前代码结构
2. 识别代码异味
3. 提出重构建议
4. 实施重构
5. 确保测试通过
6. 更新文档

## 重构原则
- 保持功能不变
- 提高可读性
- 减少重复
- 遵循 SOLID 原则

## 参数
- {file_path}: 要重构的文件路径
```

#### 29. 为代码检查创建命令
创建一个 `/lint` 命令。

**创建文件：** `.claude/slash_commands/lint.md`
```markdown
# Code Lint

## 指令
对 {target} 进行代码检查：

1. 运行 ESLint/Prettier
2. 检查类型错误
3. 识别潜在问题
4. 自动修复可修复的问题
5. 报告无法自动修复的问题

## 检查项
- 代码风格
- 类型安全
- 最佳实践
- 性能问题

## 参数
- {target}: 文件路径或目录（默认: .）
```

#### 30. 为 PR 审查创建命令
创建一个 `/review_pr` 命令。

**创建文件：** `.claude/slash_commands/review_pr.md`
```markdown
# Review Pull Request

## 指令
审查 Pull Request #{pr_number}：

1. 读取 PR 描述和变更
2. 分析代码质量
3. 检查测试覆盖率
4. 识别潜在问题
5. 提供改进建议
6. 生成审查评论

## 审查重点
- 代码质量
- 安全性
- 性能影响
- 向后兼容性
- 文档完整性

## 参数
- {pr_number}: Pull Request 编号
```

#### 31. 向命令传递参数
你的自定义斜杠命令是提示模板，可以接收命令行参数。

**参数语法：**
```
/command_name arg1 arg2 arg3
```

**示例：**
```
/refactor src/components/Header.tsx
/solve_issue 456
/review_pr 789
/lint src/
```

---

### 六、UI 与工作流技巧（3条）

#### 32. 使用 Tab 补全
用 Tab 键自动补全文件和目录名，以提供更精准的上下文。

**Tab 补全示例：**
```
你：请优化 src/co[TAB]
    → src/components/

你：请优化 src/components/He[TAB]
    → src/components/Header.tsx
```

**好处：**
- 避免路径错误
- 提供精确上下文
- 加快输入速度

#### 33. 果断按 Esc 中断
当你看到 Claude Code 的输出偏离预期时，立即按 `Esc` 键打断它。

**使用场景：**
- 生成的代码方向错误
- 误解了你的意图
- 开始生成不需要的内容

**操作流程：**
```
1. 发现输出偏离预期
2. 立即按 Esc
3. 重新澄清需求
4. 继续正确的方向
```

#### 34. 使用 undo 撤销
打断后，可以要求它 `undo`（撤销）上一步的操作。

**撤销示例：**
```
你：[按 Esc 中断]
    undo，刚才的修改不对

Claude：
已撤销最后的修改，文件已恢复到之前的状态。
请告诉我正确的修改方向。
```

**撤销命令：**
- `undo` - 撤销最后一次修改
- `undo all` - 撤销本次对话的所有修改
- `undo src/app.js` - 撤销特定文件的修改

---

## 🎯 技巧应用场景

### 场景一：快速原型开发
结合技巧：**11, 12, 32, 33**
```
1. 截图设计稿（技巧11）
2. 生成初始代码
3. 建立视觉反馈循环（技巧12）
4. 使用 Tab 补全精确指定文件（技巧32）
5. 及时中断错误方向（技巧33）
```

### 场景二：代码质量提升
结合技巧：**27, 28, 29, 30**
```
1. 使用 /lint 检查代码（技巧29）
2. 使用 /refactor 重构（技巧28）
3. 创建 PR 并使用 /review_pr（技巧30）
4. 关联 GitHub issue 解决问题（技巧27）
```

### 场景三：自动化工作流
结合技巧：**3, 4, 5, 6, 13**
```
1. 编写自动化脚本（技巧3）
2. 与其他工具联接（技巧4）
3. 使用管道处理数据（技巧5）
4. 运行多个实例并行处理（技巧6）
5. 自动截图验证（技巧13）
```

### 场景四：项目定制化
结合技巧：**19, 20, 21, 22, 23**
```
1. 运行 /init 生成项目配置（技巧20）
2. 设置全局偏好（技巧22）
3. 为子模块添加特定配置（技巧23）
4. 动态更新规则（技巧21）
5. 定期优化配置（技巧24）
```

## 💡 最佳实践

### 技巧组合策略

**初学者路径：**
1. 掌握基础技巧：1, 8, 9, 10, 32, 33, 34
2. 学习配置：19, 20, 21
3. 探索进阶：4, 5, 11, 12

**中级开发者路径：**
1. 熟练使用：所有基础技巧
2. 配置优化：22, 23, 24, 25
3. 自定义命令：26-31
4. 工具集成：14-18

**高级开发者路径：**
1. 精通所有技巧
2. 建立自动化工作流：3-7
3. 深度集成：14-18
4. 团队规范：22, 23, 26-31

### 效率提升对比

| 技能等级 | 掌握技巧数 | 效率提升 |
|---------|----------|---------|
| 初级 | 10-15 | 2-3x |
| 中级 | 20-25 | 5-7x |
| 高级 | 30-34 | 10x+ |

## 🚀 下一步

### 深入学习
- 📖 [第九课：提示词优化技巧](./09-提示词优化技巧.md) - 提升交互效率
- 📖 [第十课：AI 子代理系统](./10-AI子代理系统.md) - 构建专家团队

### 实战练习
1. **练习1**：设置你的第一个 `claude.md`
2. **练习2**：创建 3 个自定义斜杠命令
3. **练习3**：从设计稿生成完整界面
4. **练习4**：建立自动化代码审查流程
5. **练习5**：配置 MCP 连接数据库

### 进阶挑战
1. 构建完整的自动化工作流（结合 10+ 技巧）
2. 为团队创建标准化的配置模板
3. 开发自定义 MCP 服务器
4. 实现视觉驱动的开发流程

---

📚 [返回教程目录](../README.md)
