# 模块 2: 项目结构搭建

> 搭建专业的项目目录结构和开发环境

## 学习目标

完成本模块后,你将能够:
- 创建组织良好的项目目录结构
- 使用 Git 初始化版本控制
- 配置开发环境
- 安装和配置必要的依赖包

## 概述

良好的项目结构对于可维护性和可扩展性至关重要。在本模块中,我们将为 Todo App Pro 项目打下基础。

## 1. 创建项目目录

### 基础项目设置

**你与 Claude 的对话**:
```
你:为 todo-app-pro 创建目录结构

Claude:
我将为你创建专业的项目结构:

todo-app-pro/
├── client/                    # 前端代码
│   ├── index.html
│   ├── login.html
│   ├── register.html
│   ├── css/
│   │   ├── style.css
│   │   ├── components.css
│   │   └── responsive.css
│   ├── js/
│   │   ├── app.js
│   │   ├── task.js
│   │   ├── ui.js
│   │   ├── api.js
│   │   ├── auth.js
│   │   └── storage.js
│   └── assets/
│       └── images/
├── server/                   # 后端代码
│   ├── index.js
│   ├── routes/
│   ├── models/
│   └── middleware/
├── package.json
├── .gitignore
└── README.md

让我为你创建这个结构。
```

### 使用 Claude 创建目录

**逐步创建**:
```
你:创建项目的所有目录

Claude: 我将创建完整的目录结构:

# 创建主项目目录
mkdir todo-app-pro
cd todo-app-pro

# 创建前端目录
mkdir -p client/css
mkdir -p client/js
mkdir -p client/assets/images

# 创建后端目录
mkdir -p server/routes
mkdir -p server/models
mkdir -p server/middleware

# 创建测试目录
mkdir tests

项目结构创建成功!
```

## 2. 版本控制设置

### 初始化 Git 仓库

**你与 Claude 的对话**:
```
你:为这个项目设置 Git

Claude:
我将帮你初始化 Git 并创建合适的 .gitignore 文件:

1. 初始化 Git 仓库:
   git init

2. 创建 .gitignore 文件,包含以下内容:
```

**.gitignore**:
```
# 依赖包
node_modules/
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# 环境变量
.env
.env.local
.env.production

# 数据库
*.db
*.sqlite
*.sqlite3

# 操作系统文件
.DS_Store
Thumbs.db

# IDE
.vscode/
.idea/
*.swp
*.swo
*~

# 构建文件
dist/
build/
*.log

# 测试覆盖率
coverage/
.nyc_output/
```

**首次提交**:
```
你:进行第一次提交

Claude:
git add .
git commit -m "初始化项目结构"

✅ 首次提交创建完成!
💡 你的项目现在已处于版本控制之下
```

### 连接到远程仓库

```
你:将项目连接到 GitHub

Claude:
1. 在 GitHub 上创建一个新仓库 (不要初始化 README)

2. 添加远程仓库并推送:
   git remote add origin https://github.com/yourusername/todo-app-pro.git
   git branch -M main
   git push -u origin main

✅ 项目已推送到 GitHub!
```

## 3. 包配置

### 创建 package.json

**你与 Claude 的对话**:
```
你:为项目设置 package.json

Claude:
我将创建一个完整的 package.json 文件:
```

**package.json**:
```json
{
  "name": "todo-app-pro",
  "version": "1.0.0",
  "description": "专业的任务管理应用",
  "main": "server/index.js",
  "scripts": {
    "start": "node server/index.js",
    "dev": "nodemon server/index.js",
    "test": "jest",
    "client": "cd client && live-server",
    "server": "nodemon server/index.js",
    "both": "concurrently \"npm run client\" \"npm run server\""
  },
  "keywords": ["todo", "task-manager", "web-app"],
  "author": "你的名字",
  "license": "MIT",
  "dependencies": {
    "express": "^4.18.2",
    "cors": "^2.8.5",
    "dotenv": "^16.3.1",
    "bcryptjs": "^2.4.3",
    "jsonwebtoken": "^9.0.2",
    "better-sqlite3": "^9.0.0"
  },
  "devDependencies": {
    "nodemon": "^3.0.1",
    "jest": "^29.7.0",
    "concurrently": "^8.2.1"
  }
}
```

### 安装依赖包

**你与 Claude 的对话**:
```
你:安装所有必要的包

Claude:
我将引导你安装依赖包:

1. 后端依赖:
npm install express cors dotenv bcryptjs jsonwebtoken better-sqlite3

各包用途:
- express: Node.js 的 Web 框架
- cors: 启用跨域请求
- dotenv: 管理环境变量
- bcryptjs: 密码哈希加密
- jsonwebtoken: JWT 身份验证
- better-sqlite3: SQLite 数据库驱动

2. 开发依赖:
npm install --save-dev nodemon jest concurrently

各包用途:
- nodemon: 代码改变时自动重启服务器
- jest: 测试框架
- concurrently: 同时运行多个命令

✅ 所有依赖已安装!
```

## 4. 环境配置

### 创建环境变量

**你与 Claude 的对话**:
```
你:设置环境变量

Claude:
在根目录创建 .env 文件:
```

**.env**:
```
# 服务器配置
PORT=3000
NODE_ENV=development

# 数据库
DB_PATH=./database/tasks.db

# JWT 配置
JWT_SECRET=你的密钥-生产环境要修改
JWT_EXPIRE=7d

# 前端 URL (用于 CORS)
CLIENT_URL=http://localhost:8080
```

**.env.example** (用于团队共享):
```
# 服务器配置
PORT=3000
NODE_ENV=development

# 数据库
DB_PATH=./database/tasks.db

# JWT 配置
JWT_SECRET=修改此密钥
JWT_EXPIRE=7d

# 前端 URL (用于 CORS)
CLIENT_URL=http://localhost:8080
```

**加载环境变量**:
```javascript
// server/index.js (开头部分)
require('dotenv').config();

const PORT = process.env.PORT || 3000;
const JWT_SECRET = process.env.JWT_SECRET;
```

## 5. 创建基础文件

### 设置 HTML 模板

**你与 Claude 的对话**:
```
你:为主页面创建基础 HTML 模板

Claude:
我将创建一个简洁的 HTML5 模板:
```

**client/index.html**:
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="专业的任务管理应用">
    <title>Todo App Pro - 任务管理</title>

    <!-- 样式表 -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <div id="app">
        <!-- 应用内容将注入这里 -->
        <div class="loading">加载中...</div>
    </div>

    <!-- 脚本 -->
    <script src="js/storage.js"></script>
    <script src="js/task.js"></script>
    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
```

### 创建基础 CSS

**client/css/style.css** (起始版本):
```css
/* CSS 重置 */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

/* CSS 变量 */
:root {
    --primary-color: #3498db;
    --secondary-color: #2ecc71;
    --danger-color: #e74c3c;
    --warning-color: #f39c12;
    --dark-color: #2c3e50;
    --light-color: #ecf0f1;
    --text-color: #333;
    --border-color: #ddd;

    --spacing-sm: 0.5rem;
    --spacing-md: 1rem;
    --spacing-lg: 2rem;

    --border-radius: 4px;
    --box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* 基础样式 */
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    line-height: 1.6;
    color: var(--text-color);
    background-color: #f5f5f5;
}

/* 实用类 */
.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 var(--spacing-md);
}

.btn {
    padding: var(--spacing-sm) var(--spacing-md);
    border: none;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 1rem;
    transition: all 0.3s ease;
}

.btn-primary {
    background-color: var(--primary-color);
    color: white;
}

.btn-primary:hover {
    background-color: #2980b9;
}
```

### 创建基础 JavaScript 文件

**client/js/app.js** (起始版本):
```javascript
// 主应用逻辑
const TodoApp = {
    init() {
        console.log('Todo App Pro 已初始化');
        this.loadTasks();
        this.setupEventListeners();
    },

    loadTasks() {
        // 将在下一个模块中实现
        console.log('加载任务中...');
    },

    setupEventListeners() {
        // 将在下一个模块中实现
        console.log('设置事件监听器...');
    }
};

// DOM 准备好后初始化应用
document.addEventListener('DOMContentLoaded', () => {
    TodoApp.init();
});
```

**server/index.js** (起始版本):
```javascript
require('dotenv').config();
const express = require('express');
const cors = require('cors');

const app = express();
const PORT = process.env.PORT || 3000;

// 中间件
app.use(cors());
app.use(express.json());
app.use(express.static('client'));

// 基础路由
app.get('/api/health', (req, res) => {
    res.json({ status: 'OK', message: '服务器运行正常' });
});

// 启动服务器
app.listen(PORT, () => {
    console.log(`服务器运行在 http://localhost:${PORT}`);
});
```

## 6. 设置开发环境

### VS Code 配置

**你与 Claude 的对话**:
```
你:为这个项目配置 VS Code

Claude:
创建 .vscode/settings.json 文件:
```

**.vscode/settings.json**:
```json
{
    "editor.formatOnSave": true,
    "editor.tabSize": 2,
    "files.exclude": {
        "node_modules": true,
        "*.db": true
    },
    "emmet.includeLanguages": {
        "javascript": "javascriptreact"
    },
    "liveServer.settings.port": 8080
}
```

**.vscode/extensions.json** (推荐扩展):
```json
{
    "recommendations": [
        "dbaeumer.vscode-eslint",
        "esbenp.prettier-vscode",
        "ritwickdey.liveserver",
        "ms-vscode.vscode-node-debug2"
    ]
}
```

### 测试设置

**你与 Claude 的对话**:
```
你:如何测试所有设置是否正确?

Claude:
按照以下步骤验证设置:

1. 测试服务器:
   npm run dev

   预期输出:
   服务器运行在 http://localhost:3000

2. 测试健康检查端点:
   curl http://localhost:3000/api/health

   预期响应:
   {"status":"OK","message":"服务器运行正常"}

3. 测试前端:
   - 打开另一个终端
   - cd client
   - npx live-server

   预期: 浏览器打开 http://localhost:8080

4. 验证 Git:
   git status

   预期: 工作目录干净

✅ 如果所有测试通过,你的设置就完成了!
```

## 7. 创建 README 文档

**README.md**:
```markdown
# Todo App Pro

使用原生 JavaScript 和 Node.js 构建的专业任务管理应用。

## 功能特性

- 用户认证 (注册/登录)
- 创建、编辑、删除任务
- 任务分类和优先级
- 搜索和过滤功能
- 响应式设计
- SQLite 数据持久化

## 技术栈

**前端:**
- HTML5
- CSS3
- 原生 JavaScript

**后端:**
- Node.js
- Express.js
- SQLite

## 快速开始

### 前置要求
- Node.js (v14 或更高版本)
- npm 或 yarn

### 安装

1. 克隆仓库:
```bash
git clone https://github.com/yourusername/todo-app-pro.git
cd todo-app-pro
```

2. 安装依赖:
```bash
npm install
```

3. 设置环境变量:
```bash
cp .env.example .env
# 编辑 .env 文件配置你的设置
```

4. 启动开发服务器:
```bash
npm run dev
```

5. 在浏览器中打开 `http://localhost:3000`

## 项目结构

```
todo-app-pro/
├── client/          # 前端代码
├── server/          # 后端代码
├── tests/           # 测试文件
└── package.json     # 依赖配置
```

## 开发

- `npm run dev` - 启动开发服务器
- `npm test` - 运行测试
- `npm run both` - 同时运行前后端

## 许可证

MIT
```

## 8. 验证检查清单

在进入下一个模块之前,验证:

```
✅ 项目目录结构已创建
✅ Git 仓库已初始化
✅ .gitignore 已配置
✅ package.json 已创建
✅ 依赖已安装
✅ 环境变量已设置
✅ 基础 HTML/CSS/JS 文件已创建
✅ 服务器运行无错误
✅ 前端可访问
✅ README.md 已文档化
```

## 关键要点

1. **组织结构** - 良好的目录结构节省后续时间
2. **版本控制** - 从一开始就设置 Git
3. **环境配置** - 使用 .env 存储敏感数据
4. **文档** - 在构建过程中编写 README
5. **测试** - 验证每个设置步骤都有效

## 实践练习

**任务**: 为不同项目设置类似结构
1. 为"博客平台"创建项目目录
2. 初始化 Git 仓库
3. 设置 package.json 和适当的依赖
4. 创建基础文件 (HTML, CSS, JS)
5. 在 README 中记录

## 下一步

现在项目结构已准备好,继续:

👉 **[模块 3: 静态页面设计](./03-静态页面.md)** - 构建用户界面

---

📚 **返回**: [第六课概述](./index.md)
