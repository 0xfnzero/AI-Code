# 第二课：安装和配置 Claude Code

> 🎯 **学习目标**：完成 Claude Code 的安装，成功运行第一次对话

## 课前准备

在开始之前，请确保：
- ✅ 已经阅读第一课，了解什么是 Claude Code
- ✅ 电脑可以连接网络
- ✅ 有大约 30 分钟的时间

## 1. 找到并打开终端

### Windows 用户

**方法一：搜索打开**
1. 按 `Win` 键
2. 输入 `cmd` 或 `PowerShell`
3. 点击打开

**方法二：快捷键**
- 按 `Win + R`
- 输入 `cmd`
- 按回车

### Mac 用户

**方法一：搜索打开**
1. 按 `Command + 空格`
2. 输入 `Terminal` 或 `终端`
3. 按回车

**方法二：从应用程序打开**
- 打开"应用程序"文件夹
- 进入"实用工具"
- 双击"终端"

### Linux 用户

- 快捷键：`Ctrl + Alt + T`
- 或从应用程序菜单中找到 Terminal

### 终端是什么样的？

打开后你会看到类似这样的黑色或白色窗口：

```
user@computer:~$
```

或者

```
C:\Users\YourName>
```

**不要被吓到！** 这就是你和电脑"对话"的地方。

## 2. 安装 Node.js

### 为什么需要 Node.js？

Node.js 是 Claude Code 运行的基础环境，就像手机需要操作系统一样。

### 检查是否已安装

在终端中输入以下命令（输入后按回车）：

```bash
node --version
```

**如果看到类似 `v18.0.0` 的版本号** → 跳过安装，直接到第 3 步
**如果看到错误信息** → 继续往下看安装步骤

### Windows 安装

1. **下载安装包**
   - 访问：https://nodejs.org/
   - 点击"LTS"版本（推荐版本）
   - 下载并运行安装程序

2. **安装步骤**
   - 双击下载的文件
   - 一路点击"下一步"
   - 保持默认选项即可
   - 等待安装完成

3. **验证安装**
   ```bash
   node --version
   npm --version
   ```

   应该看到两个版本号

### Mac 安装

**方法一：使用官方安装包（推荐新手）**

1. 访问 https://nodejs.org/
2. 下载 LTS 版本
3. 双击安装包
4. 按照提示完成安装

**方法二：使用 Homebrew（推荐懂技术的用户）**

```bash
# 如果没有 Homebrew，先安装它
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# 安装 Node.js
brew install node

# 验证安装
node --version
```

### Ubuntu/Debian Linux 安装

```bash
# 添加 Node.js 仓库
curl -fsSL https://deb.nodesource.com/setup_lts.x | sudo bash -

# 安装 Node.js
sudo apt-get install -y nodejs

# 验证安装
node --version
npm --version
```

## 3. 安装 Claude Code

### 一条命令搞定

在终端中输入：

```bash
npm install -g @anthropic-ai/claude-code
```

**解释**：
- `npm`：Node.js 的包管理工具
- `install`：安装命令
- `-g`：全局安装（在任何地方都能使用）
- `@anthropic-ai/claude-code`：Claude Code 的包名

### 等待安装

你会看到类似这样的输出：

```
⸨░░░░░░░░░░░░░░░░░░⸩ ⠧ reify:@anthropic-ai/claude-code: ...
```

**不要关闭窗口，等待进度条完成！** 通常需要 1-3 分钟。

### 验证安装

安装完成后，输入：

```bash
claude --version
```

如果看到版本号，说明安装成功！ 🎉

### 常见安装问题

**问题 1：权限错误**
```
Error: EACCES: permission denied
```

**解决方法**（Mac/Linux）：
```bash
sudo npm install -g @anthropic-ai/claude-code
# 会提示输入密码
```

**问题 2：网络超时**
```
Error: network timeout
```

**解决方法**：
- 检查网络连接
- 多试几次
- 或使用国内镜像：
```bash
npm config set registry https://registry.npmmirror.com
npm install -g @anthropic-ai/claude-code
```

## 4. 获取 API 密钥

### 什么是 API 密钥？

API 密钥就像你的"身份证"，让 Claude Code 知道是你在使用。

### 如何获取？

API 密钥通常由服务提供商发给你，格式类似：

```
cr_xxxxxxxxxxxxxxxxxxxxx
```

> ⚠️ **注意**：API 密钥是私密的，不要分享给别人！

### 配置 API 密钥和服务地址

你需要配置两个信息：
1. **API 密钥** (`ANTHROPIC_AUTH_TOKEN`)
2. **API 地址** (`ANTHROPIC_BASE_URL`)

## 5. 配置环境变量

### 什么是环境变量？

环境变量就像给电脑设置的"备忘录"，让 Claude Code 知道你的 API 信息。

### 临时配置（本次会话有效）

#### Windows (CMD)

```cmd
set ANTHROPIC_AUTH_TOKEN=你的API密钥
set ANTHROPIC_BASE_URL=你的API地址
```

#### Windows (PowerShell)

```powershell
$env:ANTHROPIC_AUTH_TOKEN="你的API密钥"
$env:ANTHROPIC_BASE_URL="你的API地址"
```

#### Mac/Linux

```bash
export ANTHROPIC_AUTH_TOKEN="你的API密钥"
export ANTHROPIC_BASE_URL="你的API地址"
```

### 永久配置（推荐）

#### Mac/Linux

1. **打开配置文件**

```bash
# 如果使用 bash
nano ~/.bashrc

# 如果使用 zsh (Mac 默认)
nano ~/.zshrc
```

2. **添加以下内容**

```bash
export ANTHROPIC_AUTH_TOKEN="你的API密钥"
export ANTHROPIC_BASE_URL="你的API地址"
```

3. **保存并退出**
   - 按 `Ctrl + O` 保存
   - 按 `Enter` 确认
   - 按 `Ctrl + X` 退出

4. **使配置生效**

```bash
source ~/.bashrc  # 或 source ~/.zshrc
```

#### Windows

1. **打开环境变量设置**
   - 右键"此电脑" → "属性"
   - 点击"高级系统设置"
   - 点击"环境变量"

2. **添加用户变量**
   - 点击"新建"
   - 变量名：`ANTHROPIC_AUTH_TOKEN`
   - 变量值：你的 API 密钥
   - 再次点击"新建"
   - 变量名：`ANTHROPIC_BASE_URL`
   - 变量值：你的 API 地址

3. **确定并重启终端**

## 6. 第一次运行

### 创建测试项目

```bash
# 创建一个测试文件夹
mkdir claude-test
cd claude-test
```

**解释**：
- `mkdir`：创建文件夹（make directory）
- `claude-test`：文件夹名称
- `cd`：进入文件夹（change directory）

### 启动 Claude Code

```bash
claude
```

### 首次运行配置

第一次运行时，Claude Code 会问你几个问题：

**1. 选择主题**
```
? 选择你喜欢的主题：
  ❯ Light (亮色)
    Dark (暗色)
    Auto (自动)
```
用方向键选择，按 `Enter` 确认

**2. 安全须知**
```
⚠️  Claude Code 可以读写文件和执行命令
是否同意？ (y/N)
```
输入 `y` 然后按 `Enter`

**3. Terminal 配置**
```
使用默认 Terminal 配置？ (Y/n)
```
按 `Enter`（使用默认）

**4. 信任工作目录**
```
是否信任当前目录？ (Y/n)
```
按 `Enter`（是的，信任）

### 成功！

现在你应该看到：

```
╭─────────────────────────────────────╮
│ Claude Code 已就绪                  │
│ 你的 AI 编程助手正在等待你的指令   │
╰─────────────────────────────────────╯

你：▌
```

## 7. 测试对话

### 第一次对话

输入：

```
你好，请介绍一下自己
```

按 `Enter`，Claude Code 会回复你！

### 简单测试

```
你：帮我创建一个简单的 HTML 文件，显示 "Hello World"
```

Claude Code 会：
1. 创建 `index.html` 文件
2. 写入基本的 HTML 代码
3. 告诉你文件已创建

### 验证结果

```bash
# 查看创建的文件
ls

# 查看文件内容 (Mac/Linux)
cat index.html

# 查看文件内容 (Windows)
type index.html
```

## 8. 常用命令速查

### 终端基础命令

| 命令 | 作用 | 示例 |
|------|------|------|
| `ls` (Mac/Linux) | 列出文件 | `ls` |
| `dir` (Windows) | 列出文件 | `dir` |
| `cd` | 切换目录 | `cd my-project` |
| `cd ..` | 返回上级目录 | `cd ..` |
| `pwd` | 显示当前路径 | `pwd` |
| `mkdir` | 创建文件夹 | `mkdir test` |

### Claude Code 命令

| 命令 | 作用 |
|------|------|
| `claude` | 启动 Claude Code |
| `claude --version` | 查看版本 |
| `claude --help` | 查看帮助 |
| `/exit` | 退出 Claude Code |
| `/clear` | 清空对话历史 |

## 9. 配置文件位置

### 配置文件保存在哪里？

- **Mac/Linux**: `~/.config/claude-code/`
- **Windows**: `C:\Users\你的用户名\.config\claude-code\`

### 如果需要重置配置

```bash
# Mac/Linux
rm -rf ~/.config/claude-code

# Windows (PowerShell)
Remove-Item -Recurse -Force $env:USERPROFILE\.config\claude-code
```

## 10. 故障排查

### Claude Code 无法启动

**检查清单**：
1. ✅ Node.js 已正确安装（`node --version`）
2. ✅ Claude Code 已正确安装（`claude --version`）
3. ✅ 环境变量已正确设置
4. ✅ 网络连接正常

### 提示 API 错误

```
Error: Invalid API key
```

**解决方法**：
1. 检查 API 密钥是否正确
2. 重新设置环境变量
3. 重启终端

### 命令找不到

```
'claude' is not recognized as an internal or external command
```

**解决方法**：
1. 重新安装 Claude Code
2. 重启终端
3. 检查 PATH 环境变量

## 11. 下一步

🎉 恭喜你完成安装和配置！

现在你已经：
- ✅ 安装了 Node.js
- ✅ 安装了 Claude Code
- ✅ 配置了 API 密钥
- ✅ 成功运行了第一次对话

**准备好进入实战了吗？**

👉 下一课：[第一次对话 - 创建你的第一个项目](./03-第一次对话.md)

在那里，我们会：
1. 学习如何和 Claude Code 有效沟通
2. 创建一个完整的小项目
3. 理解 Claude Code 的工作流程
4. 掌握基本的交互技巧

---

💡 **小贴士**：
- 把 API 密钥保存在安全的地方
- 如果遇到问题，先查看本课的"故障排查"部分
- 不要着急，慢慢来，每个命令都可以多试几次
